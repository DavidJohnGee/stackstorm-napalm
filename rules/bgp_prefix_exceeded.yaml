---
  name: "bgp_prefix_exceeded_webhook_rule"
  enabled: true
  description: "Webhook which handles a BGP neighbour exceeding it's prefix limit"

  trigger:
    type: "core.st2.webhook"
    parameters:
      url: "napalm_bgp_prefix_exceeded"

  criteria: {}

  action:
    ref: napalm.bgp_prefix_exceeded_workflow
    parameters:
      host: "{{trigger.body.logsource}}"
      neighbour: "{{trigger.body.neighbour}}"
      asnum: "{{trigger.body.asnum}}"
      prefixes: "{{trigger.body.prefixes}}"
